import{r as c,B as ie,aa as ce,ab as de,ac as oe,ad as me,ae as xe,j as e,F as G,e as H,af as U,ag as he,ah as ue,O as je,Z as ge,s as L,U as pe,i as ve,J as fe,ai as k,l as S}from"./vendor-react-DTfwnz2i.js";import{N as Ne}from"./Navigation-DYALYri8.js";import{B as i,C as r,f as l,a as w,b as A,d as F,e as P}from"./badge-Bk34XC_J.js";import{I as V}from"./input-BMLotNza.js";import{P as y}from"./progress-CSXUF28C.js";import{T as be,a as we,b as R,c as B}from"./tabs-V_RvRFQ7.js";import{I as ye}from"./ImageWithFallback-BM0CHYyg.js";import{D as Ie,b as Ce,c as Te,d as De,e as Le}from"./dialog-BD2p6u1S.js";import{L as ke}from"./label-qGWvcckI.js";import{b as Se,p as Y}from"./index-BR7N1bNZ.js";import{t as j}from"./vendor-ui-9zUGSSqf.js";import"./vendor-Cgdd8BZB.js";import"./separator-Bu3GtbjQ.js";function Ve({onNavigate:p}){const Q=()=>{p("landing")},{user:h,wallet:m,refreshWallet:W}=Se(),[Z,E]=c.useState("browse"),[g,J]=c.useState(""),[d,K]=c.useState([]),[X,M]=c.useState(!0),[v,q]=c.useState(null),[a,z]=c.useState(null),[u,I]=c.useState(""),[_,f]=c.useState(!1),[C,ee]=c.useState(!1);c.useEffect(()=>{O()},[]);const O=async()=>{try{M(!0);const s=await Y.getAllProjects();K(s.projects||[])}catch(s){console.error("Error loading projects:",s),j.error("Failed to load investment projects")}finally{M(!1)}},se=async()=>{if(!h||!a||!u){j.error("Please fill in all required fields");return}const s=parseFloat(u);if(s<a.minInvestment){j.error(`Minimum investment is ${a.minInvestment} TND`);return}if(!m||m.money<s){j.error("Insufficient funds in your wallet");return}try{q(a.id),(await Y.makeInvestment(a.id,h.id,s)).success&&(j.success(`Successfully invested ${s} TND in ${a.title}!`),f(!1),I(""),z(null),await W(),await O())}catch(t){console.error("Error making investment:",t),j.error("Failed to make investment")}finally{q(null)}},te=s=>{z(s),I(s.minInvestment.toString()),f(!0)},T=(()=>{let s=d;if(g&&(s=s.filter(t=>t.title.toLowerCase().includes(g.toLowerCase())||t.description.toLowerCase().includes(g.toLowerCase())||t.category.toLowerCase().includes(g.toLowerCase()))),C&&h){const t=new Set(o.map(n=>n.category));s=s.sort((n,x)=>{let N=0,b=0;return t.has(n.category)&&(N+=2),t.has(x.category)&&(b+=2),m&&m.equity<500&&(n.riskLevel==="Low"&&(N+=1),x.riskLevel==="Low"&&(b+=1)),parseFloat(n.expectedReturn.split("-")[0])>parseFloat(x.expectedReturn.split("-")[0])&&(N+=1),parseFloat(x.expectedReturn.split("-")[0])>parseFloat(n.expectedReturn.split("-")[0])&&(b+=1),b-N})}return s})(),o=d.filter(s=>s.investors.some(t=>t.investorId===h?.id)),D=o.reduce((s,t)=>{const n=t.investors.find(x=>x.investorId===h?.id);return s+(n?.amount||0)},0),$=o.reduce((s,t)=>{const n=t.investors.find(x=>x.investorId===h?.id);return s+(n?.equityPercentage||0)},0),ne=[{name:"Tech Startups",icon:ie,count:d.filter(s=>s.category==="Tech Startup").length,color:"bg-blue-500"},{name:"Real Estate",icon:ce,count:d.filter(s=>s.category==="Real Estate").length,color:"bg-green-500"},{name:"Retail",icon:de,count:d.filter(s=>s.category==="Retail").length,color:"bg-purple-500"},{name:"Food & Beverage",icon:oe,count:d.filter(s=>s.category==="Food & Beverage").length,color:"bg-orange-500"},{name:"Transport",icon:me,count:d.filter(s=>s.category==="Transport").length,color:"bg-red-500"},{name:"Local Business",icon:xe,count:d.filter(s=>s.category==="Local Business").length,color:"bg-indigo-500"}],ae=s=>{switch(s.toLowerCase()){case"low":return"text-green-500 bg-green-500/10";case"medium":return"text-yellow-500 bg-yellow-500/10";case"high":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},re=s=>{switch(s.toLowerCase()){case"low":return e.jsx(S,{className:"h-4 w-4"});case"medium":return e.jsx(k,{className:"h-4 w-4"});case"high":return e.jsx(k,{className:"h-4 w-4"});default:return e.jsx(S,{className:"h-4 w-4"})}},le=s=>{switch(s){case"active":return"text-blue-500 bg-blue-500/10";case"completed":return"text-green-500 bg-green-500/10";case"at-risk":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Ne,{currentPage:"investment",onNavigate:p,onLogout:Q}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl mb-2",children:"Micro-Investment"}),e.jsx("p",{className:"text-muted-foreground",children:"Invest in local projects starting from 1 TND"})]}),e.jsxs(i,{className:"gap-2",onClick:()=>p("wallet"),children:[e.jsx(G,{className:"h-4 w-4"}),"Available: ",m?.money||0," TND"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(r,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Invested"}),e.jsxs("p",{className:"text-xl",children:[D," TND"]})]})]})})}),e.jsx(r,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Equity"}),e.jsxs("p",{className:"text-xl",children:[$.toFixed(2),"%"]})]})]})})}),e.jsx(r,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Available Projects"}),e.jsx("p",{className:"text-xl",children:d.length})]})]})})}),e.jsx(r,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"My Investments"}),e.jsx("p",{className:"text-xl",children:o.length})]})]})})})]}),e.jsxs(be,{value:Z,onValueChange:s=>E(s),children:[e.jsxs(we,{children:[e.jsx(R,{value:"browse",children:"Browse Projects"}),e.jsx(R,{value:"portfolio",children:"My Portfolio"}),e.jsx(R,{value:"analytics",children:"Analytics"})]}),e.jsxs(B,{value:"browse",className:"space-y-6",children:[e.jsx(r,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Search investment opportunities...",value:g,onChange:s=>J(s.target.value),className:"pl-10"})]}),e.jsxs(i,{variant:C?"default":"outline",onClick:()=>ee(!C),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"AI Recommendations"]})]})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg mb-4",children:"Browse by Category"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:ne.map((s,t)=>{const n=s.icon;return e.jsx(r,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx("div",{className:`${s.color} text-white p-2 rounded-lg w-fit mx-auto mb-2`,children:e.jsx(n,{className:"h-5 w-5"})}),e.jsx("p",{className:"text-sm",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.count," projects"]})]})},t)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg",children:"Featured Investment Opportunities"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[T.length," projects available"]})]}),X?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(L,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading investment opportunities..."})]}):T.length===0?e.jsx(r,{children:e.jsxs(l,{className:"p-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No investment opportunities available at the moment."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Check back later for new projects!"})]})}):e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:T.map(s=>e.jsxs(r,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ye,{src:"https://images.unsplash.com/photo-1521897258701-21e2a01f5bb8?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",alt:s.title,className:"w-full h-48 object-cover rounded-t-lg"}),e.jsxs(w,{className:`absolute top-3 right-3 ${ae(s.riskLevel.toLowerCase())}`,children:[re(s.riskLevel.toLowerCase()),s.riskLevel," risk"]})]}),e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg mb-1",children:s.title}),e.jsx(w,{variant:"outline",className:"text-xs mb-2",children:s.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expected Return"}),e.jsx("p",{className:"text-green-600",children:s.expectedReturn})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:s.description}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Funding Progress"}),e.jsxs("span",{children:[Math.round(s.currentFunding/s.fundingGoal*100),"%"]})]}),e.jsx(y,{value:s.currentFunding/s.fundingGoal*100,className:"h-2 mb-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s.currentFunding.toLocaleString()," TND raised"]}),e.jsxs("span",{children:[s.fundingGoal.toLocaleString()," TND goal"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Min Investment"}),e.jsxs("p",{children:[s.minInvestment," TND"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Investors"}),e.jsx("p",{children:s.investors.length})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Status"}),e.jsx("p",{className:"capitalize",children:s.status})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Created"}),e.jsx("p",{children:new Date(s.createdAt).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",className:"flex-1",children:"Learn More"}),e.jsxs(i,{size:"sm",className:"flex-1",onClick:()=>te(s),disabled:v===s.id,children:[v===s.id&&e.jsx(L,{className:"h-4 w-4 mr-2 animate-spin"}),"Invest Now"]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>p("publicProfile",s.ownerId),children:"View Owner"})]})]})]},s.id))})]})]}),e.jsx(B,{value:"portfolio",className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg",children:"My Investment Portfolio"}),o.length===0?e.jsx(r,{children:e.jsxs(l,{className:"p-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"You haven't made any investments yet."}),e.jsx(i,{onClick:()=>E("browse"),children:"Browse Investment Opportunities"})]})}):o.map(s=>{const t=s.investors.find(n=>n.investorId===h?.id);return e.jsx(r,{children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg",children:s.title}),e.jsx(w,{className:le(s.status),children:s.status})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-8 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Invested"}),e.jsxs("p",{className:"text-lg",children:[t?.amount||0," TND"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Equity"}),e.jsxs("p",{className:"text-lg",children:[t?.equityPercentage?.toFixed(2)||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Investment Date"}),e.jsx("p",{className:"text-sm",children:t?new Date(t.investedAt).toLocaleDateString():"N/A"})]})]}),e.jsx(i,{variant:"outline",size:"sm",children:"View Details"})]})})},s.id)})]})}),e.jsxs(B,{value:"analytics",className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsxs(A,{children:[e.jsx(F,{children:"Portfolio Performance"}),e.jsx(P,{children:"Your investment performance over time"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Invested"}),e.jsxs("span",{children:[D," TND"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Equity"}),e.jsxs("span",{children:[$.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Active Projects"}),e.jsx("span",{children:o.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Average Investment"}),e.jsxs("span",{children:[o.length>0?Math.round(D/o.length):0," TND"]})]})]})})]}),e.jsxs(r,{children:[e.jsxs(A,{children:[e.jsx(F,{children:"Risk Analysis"}),e.jsx(P,{children:"AI-powered risk assessment of your portfolio"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Overall Risk Level"}),e.jsxs(w,{className:"text-yellow-500 bg-yellow-500/10",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),"Medium"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Low Risk"}),e.jsx("span",{children:"40%"})]}),e.jsx(y,{value:40,className:"h-2 mb-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Medium Risk"}),e.jsx("span",{children:"45%"})]}),e.jsx(y,{value:45,className:"h-2 mb-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"High Risk"}),e.jsx("span",{children:"15%"})]}),e.jsx(y,{value:15,className:"h-2"})]})]})})]})]}),e.jsxs(r,{children:[e.jsxs(A,{children:[e.jsx(F,{children:"AI Investment Recommendations"}),e.jsx(P,{children:"Personalized suggestions based on your portfolio and risk profile"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-500/5 rounded-lg border border-blue-500/20",children:[e.jsx(H,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm",children:"Diversify into Agriculture"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Consider the Organic Farm project to balance your tech-heavy portfolio"})]}),e.jsx(i,{size:"sm",variant:"outline",children:"View"})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-500/5 rounded-lg border border-green-500/20",children:[e.jsx(S,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm",children:"Lower Your Risk"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Add more low-risk investments to stabilize returns"})]}),e.jsx(i,{size:"sm",variant:"outline",children:"Explore"})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-500/5 rounded-lg border border-purple-500/20",children:[e.jsx(U,{className:"h-5 w-5 text-purple-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm",children:"Increase Investment Amount"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["You have ",m?.money||0," TND available for new investments"]})]}),e.jsx(i,{size:"sm",variant:"outline",children:"Invest"})]})]})})]})]})]}),e.jsx(Ie,{open:_,onOpenChange:f,children:e.jsxs(Ce,{className:"max-w-md",children:[e.jsxs(Te,{children:[e.jsxs(De,{children:["Invest in ",a?.title]}),e.jsxs(Le,{children:["Enter the amount you want to invest (Min: ",a?.minInvestment," TND)"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ke,{htmlFor:"amount",children:"Investment Amount (TND)"}),e.jsx(V,{id:"amount",type:"number",placeholder:a?.minInvestment.toString(),value:u,onChange:s=>I(s.target.value),min:a?.minInvestment,max:m?.money}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Available balance: ",m?.money||0," TND"]})]}),a&&u&&e.jsxs("div",{className:"bg-muted p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:"Investment Summary:"}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{children:"Amount:"}),e.jsxs("span",{children:[u," TND"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Equity:"}),e.jsxs("span",{children:[(parseFloat(u)/a.fundingGoal*100).toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Expected Return:"}),e.jsx("span",{children:a.expectedReturn})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(i,{onClick:se,disabled:v!==null,children:v===null?"Confirm Investment":e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-4 w-4 mr-2 animate-spin"}),"Investing..."]})})]})]})]})})]})]})}export{Ve as InvestmentMode};
//# sourceMappingURL=InvestmentMode-DTwUFUL5.js.map
