const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BR7N1bNZ.js","assets/vendor-react-DTfwnz2i.js","assets/vendor-Cgdd8BZB.js","assets/vendor-ui-9zUGSSqf.js","assets/index-CBttMiwO.css"])))=>i.map(i=>d[i]);
import{u as Z,_ as F}from"./index-BR7N1bNZ.js";import{j as e,r as u,n as G,L as J,o as K,E as A,p as q,q as Q,s as k,h as Y,t as v,X as N,u as I,D as ee,v as se}from"./vendor-react-DTfwnz2i.js";import{c as O,C as ae,b as re,d as te,e as le,a as R,f as ne,B as i}from"./badge-Bk34XC_J.js";import{I as g}from"./input-BMLotNza.js";import{L as p}from"./label-qGWvcckI.js";import{T as ie,a as oe,b as $,c as z}from"./tabs-V_RvRFQ7.js";import{D as ce,a as de,b as me,c as ue,d as he,e as xe}from"./dialog-BD2p6u1S.js";import{P as ge}from"./progress-CSXUF28C.js";import{v as pe}from"./vendor-Cgdd8BZB.js";import{t as n}from"./vendor-ui-9zUGSSqf.js";const we=pe("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function je({className:w,variant:j,...C}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:O(we({variant:j}),w),...C})}function fe({className:w,...j}){return e.jsx("div",{"data-slot":"alert-description",className:O("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",w),...j})}function _e({onSuccess:w,onBack:j,defaultTab:C="login"}){const{t:s}=Z(),[o,c]=u.useState(!1),[h,T]=u.useState(!1),[U,D]=u.useState(!1),[L,_]=u.useState(""),[P,V]=u.useState(!1),[ve,Ne]=u.useState(C),[x,y]=u.useState({email:"",password:""}),[l,f]=u.useState({name:"",email:"",password:"",confirmPassword:""}),M=async a=>{a.preventDefault(),c(!0);try{const{authApi:r}=await F(async()=>{const{authApi:m}=await import("./index-BR7N1bNZ.js").then(S=>S.d);return{authApi:m}},__vite__mapDeps([0,1,2,3,4])),t=await r.signIn(x.email,x.password);t.success?(n.success(s("auth.loginSuccess")),w({userId:t.user.id,name:t.user.name,email:t.user.email})):n.error(t.error||s("auth.loginFailed"))}catch(r){console.error("Login error caught:",r),console.error("Error type:",typeof r),console.error("Error message:",r?.message),console.error("Error string:",String(r));let t=s("auth.loginFailed");r?.message?(t=r.message,console.log("Using error.message:",t)):typeof r=="string"&&(t=r,console.log("Using error string:",t)),console.log("Final error message to display:",t),n.error(t,{duration:5e3,position:"top-center"})}finally{c(!1)}},B=async a=>{if(a.preventDefault(),l.password!==l.confirmPassword){n.error(s("auth.passwordMismatch"));return}if(l.password.length<6){n.error(s("auth.passwordTooShort"));return}c(!0);try{const{authApi:r}=await F(async()=>{const{authApi:m}=await import("./index-BR7N1bNZ.js").then(S=>S.d);return{authApi:m}},__vite__mapDeps([0,1,2,3,4])),t=await r.signUp(l.email,l.password,l.name);t.success?(n.success(s("auth.registrationSuccess")),w({userId:t.user.id,name:t.user.name,email:t.user.email},!0)):n.error(t.error||s("auth.registrationFailed"))}catch(r){console.error("Registration error:",r);let t=s("auth.registrationFailed");if(r.message){if(r.message.includes("already exists")){t=r.message,n.error(t,{duration:5e3,position:"top-center",action:{label:s("auth.signIn"),onClick:()=>{const m=document.querySelector('[value="login"]');m&&m.click(),y({...x,email:l.email})}}});return}t=r.message}else typeof r=="string"&&(t=r);n.error(t,{duration:4e3,position:"top-center"})}finally{c(!1)}},H=async a=>{a.preventDefault(),c(!0);try{await new Promise(r=>setTimeout(r,1e3)),n.success(`${s("auth.resetLinkSent")} ${L}`),D(!1),_("")}catch{n.error(s("auth.resetLinkError"))}finally{c(!1)}},E=a=>({length:a.length>=6,uppercase:/[A-Z]/.test(a),lowercase:/[a-z]/.test(a),number:/\d/.test(a)}),W=a=>{if(!a)return{score:0,label:"",color:""};const r=E(a),t=Object.values(r).filter(Boolean).length;return t<=1?{score:25,label:s("auth.weak"),color:"bg-red-500"}:t<=3?{score:60,label:s("auth.medium"),color:"bg-yellow-500"}:{score:100,label:s("auth.strong"),color:"bg-green-500"}},d=E(l.password),b=W(l.password);l.password.length>=6;const X=async()=>{if(window.confirm(s("auth.cleanupConfirm"))){c(!0);try{const{cleanupDatabase:a}=await F(async()=>{const{cleanupDatabase:t}=await import("./index-BR7N1bNZ.js").then(m=>m.e);return{cleanupDatabase:t}},__vite__mapDeps([0,1,2,3,4])),r=await a();n.success(`Database cleaned! Removed ${r.removed.auth} accounts, ${r.removed.users} profiles, ${r.removed.wallets} wallets.`),y({email:"",password:""}),f({name:"",email:"",password:"",confirmPassword:""})}catch(a){console.error("Cleanup error:",a),n.error(s("auth.cleanupError")+": "+(a.message||"Unknown error"))}finally{c(!1)}}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 p-4",children:e.jsxs(ae,{className:"w-full max-w-md shadow-xl",children:[e.jsxs(re,{className:"text-center space-y-2",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"bg-primary text-primary-foreground rounded-full p-3",children:e.jsx(G,{className:"h-8 w-8"})})}),e.jsx(te,{className:"text-2xl",children:s("auth.welcome")}),e.jsx(le,{className:"text-base",children:s("auth.description")}),e.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[e.jsxs(R,{variant:"secondary",className:"text-xs",children:["🔒 ",s("auth.secureAuthentication")]}),e.jsxs(R,{variant:"secondary",className:"text-xs",children:["🌍 ",s("auth.multiLanguage")]})]})]}),e.jsxs(ne,{children:[e.jsxs(ie,{defaultValue:"login",className:"w-full",children:[e.jsxs(oe,{className:"grid w-full grid-cols-2",children:[e.jsxs($,{value:"login",className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),s("auth.login")]}),e.jsxs($,{value:"register",className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),s("auth.register")]})]}),e.jsx(z,{value:"login",children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"login-email",children:s("auth.email")}),e.jsx(g,{id:"login-email",type:"email",placeholder:s("auth.email"),value:x.email,onChange:a=>y({...x,email:a.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"login-password",children:s("auth.password")}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"login-password",type:h?"text":"password",placeholder:s("auth.password"),value:x.password,onChange:a=>y({...x,password:a.target.value}),required:!0}),e.jsx(i,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>T(!h),children:h?e.jsx(A,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(i,{variant:"link",className:"px-0 text-sm",onClick:j,children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),s("common.back")]}),e.jsxs(ce,{open:U,onOpenChange:D,children:[e.jsx(de,{asChild:!0,children:e.jsx(i,{variant:"link",className:"px-0 text-sm",children:s("auth.forgotPassword")})}),e.jsxs(me,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:s("auth.resetPassword")}),e.jsx(xe,{children:s("auth.resetPasswordDesc")})]}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"reset-email",children:s("auth.emailAddress")}),e.jsx(g,{id:"reset-email",type:"email",placeholder:s("auth.email"),value:L,onChange:a=>_(a.target.value),required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{type:"submit",disabled:o,className:"flex-1",children:o?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}),s("auth.sending")]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),s("auth.sendResetLink")]})}),e.jsx(i,{type:"button",variant:"outline",onClick:()=>D(!1),children:s("common.cancel")})]})]})]})]})]}),e.jsx(i,{type:"submit",className:"w-full",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}),s("auth.signingIn")]}):s("auth.signIn")})]})}),e.jsx(z,{value:"register",children:e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-name",children:s("auth.fullName")}),e.jsx(g,{id:"register-name",type:"text",placeholder:s("auth.fullName"),value:l.name,onChange:a=>f({...l,name:a.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-email",children:s("auth.email")}),e.jsx(g,{id:"register-email",type:"email",placeholder:s("auth.email"),value:l.email,onChange:a=>f({...l,email:a.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-password",children:s("auth.password")}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"register-password",type:h?"text":"password",placeholder:s("auth.password"),value:l.password,onChange:a=>f({...l,password:a.target.value}),required:!0}),e.jsx(i,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>T(!h),children:h?e.jsx(A,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})})]}),l.password&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("auth.passwordStrength"),":"]}),e.jsx("span",{className:`font-medium ${b.score===100?"text-green-600 dark:text-green-500":b.score===60?"text-yellow-600 dark:text-yellow-500":"text-red-600 dark:text-red-500"}`,children:b.label})]}),e.jsx(ge,{value:b.score,className:"h-2"}),e.jsxs("div",{className:"text-xs space-y-1 mt-3",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:s("auth.passwordRequirements")}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`flex items-center gap-2 ${d.length?"text-green-600 dark:text-green-500":"text-muted-foreground"}`,children:[d.length?e.jsx(v,{className:"h-3.5 w-3.5"}):e.jsx(N,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:s("auth.minLength")})]}),e.jsxs("div",{className:`flex items-center gap-2 ${d.uppercase?"text-green-600 dark:text-green-500":"text-muted-foreground"}`,children:[d.uppercase?e.jsx(v,{className:"h-3.5 w-3.5"}):e.jsx(N,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:s("auth.hasUppercase")})]}),e.jsxs("div",{className:`flex items-center gap-2 ${d.lowercase?"text-green-600 dark:text-green-500":"text-muted-foreground"}`,children:[d.lowercase?e.jsx(v,{className:"h-3.5 w-3.5"}):e.jsx(N,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:s("auth.hasLowercase")})]}),e.jsxs("div",{className:`flex items-center gap-2 ${d.number?"text-green-600 dark:text-green-500":"text-muted-foreground"}`,children:[d.number?e.jsx(v,{className:"h-3.5 w-3.5"}):e.jsx(N,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:s("auth.hasNumber")})]})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-confirm-password",children:s("auth.confirmPassword")}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"register-confirm-password",type:h?"text":"password",placeholder:s("auth.confirmPassword"),value:l.confirmPassword,onChange:a=>f({...l,confirmPassword:a.target.value}),required:!0,className:l.confirmPassword&&(l.password===l.confirmPassword?"border-green-500 dark:border-green-500":"border-red-500 dark:border-red-500")}),l.confirmPassword&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:l.password===l.confirmPassword?e.jsx(v,{className:"h-4 w-4 text-green-600 dark:text-green-500"}):e.jsx(N,{className:"h-4 w-4 text-red-600 dark:text-red-500"})})]}),l.confirmPassword&&l.password!==l.confirmPassword&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-500 flex items-center gap-1 mt-1",children:[e.jsx(I,{className:"h-3 w-3"}),s("auth.passwordMismatch")]})]}),e.jsx(i,{type:"submit",className:"w-full",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}),s("auth.creatingAccount")]}):s("auth.createAccount")})]})})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsxs(i,{type:"button",variant:"ghost",size:"sm",className:"w-full text-xs text-muted-foreground hover:text-foreground",onClick:()=>V(!P),children:[e.jsx(ee,{className:"mr-2 h-3 w-3"}),s(P?"auth.hideDeveloperTools":"auth.showDeveloperTools")]}),P&&e.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800 rounded-lg space-y-3",children:[e.jsxs(je,{className:"border-yellow-300 dark:border-yellow-700",children:[e.jsx(I,{className:"h-4 w-4 !text-yellow-600 dark:!text-yellow-500"}),e.jsxs(fe,{className:"text-xs text-yellow-800 dark:text-yellow-200",children:[e.jsxs("strong",{children:[s("auth.cleanupWarning").split(":")[0],":"]})," ",s("auth.cleanupWarning").split(":")[1]]})]}),e.jsx(i,{type:"button",variant:"destructive",size:"sm",className:"w-full",onClick:X,disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2 h-3 w-3 animate-spin"}),s("auth.cleaning")]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"mr-2 h-3 w-3"}),s("auth.resetDatabase")]})}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:s("auth.emailExistsHint")})]})]})]})]})})}export{_e as AuthForm};
//# sourceMappingURL=AuthForm-CfBscpNW.js.map
